{"ast":null,"code":"var _jsxFileName = \"/Users/samzimmerman/Documents/Apps/Website/src/Weather/Chart.tsx\";\nimport * as d3 from \"d3\";\nimport { zoomTransform } from \"d3\";\nimport React, { useRef, useEffect, useState } from \"react\";\n\nfunction Chart({\n  width,\n  height,\n  data\n}) {\n  const ref = useRef(null);\n  const [currentZoomState, setCurrentZoomState] = useState();\n  useEffect(() => {\n    const svg = d3.select(ref.current);\n    var margin = {\n      top: 20,\n      right: 50,\n      bottom: 30,\n      left: 40\n    };\n    var dateDomain = d3.extent(data, d => parseInt(d.date));\n    var tempRange = d3.extent(data, d => parseFloat(d.temps[0]));\n    var scaleX = d3.scaleUtc().domain(dateDomain).range([margin.left, width - margin.right]);\n\n    if (currentZoomState) {\n      let newXScale = currentZoomState.rescaleX(scaleX);\n      scaleX.domain(newXScale.domain());\n    }\n\n    var scaleY = d3.scaleLinear().domain(tempRange).nice().range([height - margin.bottom, margin.top]);\n\n    function yAxis(g) {\n      g.attr(\"transform\", `translate(${margin.left}, 0)`).call(d3.axisLeft(scaleY)).call(g => g.select(\".domain\").remove()).call(g => g.select(\".tick:last-of-type text\").clone().attr(\"x\", 3).attr(\"text-anchor\", \"start\").attr(\"font-weight\", \"bold\").text(\"Temperature\"));\n    } // function xAxis(g: any) {\n    //   g.attr(\"transform\", `translate(0,${height - margin.bottom})`).call(\n    //     d3\n    //       .axisBottom(scaleX)\n    //       .ticks(width / 80)\n    //       .tickSizeOuter(0)\n    //   );\n    // }\n\n\n    const xAxis = d3.axisBottom(scaleX);\n    let line = d3.line().x(d => scaleX(d.date)).y(d => scaleY(parseFloat(d.temps[0])));\n\n    function linePath(g) {\n      g.datum(data).attr(\"fill\", \"none\").attr(\"stroke\", \"steelblue\").attr(\"stroke-width\", 1.5).attr(\"stroke-linejoin\", \"round\").attr(\"stroke-linecap\", \"round\").attr(\"d\", line);\n    }\n\n    var lastTime;\n    var lastTemp;\n\n    if (data) {\n      try {\n        let index = data.length - 1;\n        lastTime = data[index].date;\n        lastTemp = parseFloat(data[index].temps[0]);\n      } catch (error) {}\n    }\n\n    function lineLabel(g) {\n      g.attr(\"transform\", \"translate(\" + (width - margin.left) + \",\" + scaleY(lastTemp) + \")\").attr(\"dy\", \".35em\").attr(\"text-anchor\", \"start\").style(\"fill\", \"steelblue\").text(lastTemp);\n    }\n\n    function endCircle(g) {\n      if (scaleY(lastTemp)) {\n        g.attr(\"fill\", \"steelblue\").attr(\"transform\", \"translate(\" + scaleX(lastTime) + \",\" + scaleY(lastTemp) + \")\").attr(\"r\", 3);\n      }\n    }\n\n    svg.attr(\"width\", width).attr(\"height\", height).style(\"border\", \"1px solid black\"); // svg.append(\"g\").call(yAxis);\n    // svg.append(\"g\").call(xAxis);\n\n    svg.select(\".x-axis\").attr(\"transform\", `translate(0,${height - margin.bottom})`).call(xAxis);\n    svg.select(\".y-axis\").call(yAxis);\n    svg.append(\"text\").call(lineLabel);\n    svg.append(\"circle\").call(endCircle); // svg.append(\"path\").call(linePath);\n\n    svg.select(\".graphContent\").selectAll(\".myLine\").data([data]).join(\"path\").attr(\"class\", \"myLine\").attr(\"stroke\", \"steelblue\").attr(\"fill\", \"none\").attr(\"stroke-width\", 1.5).attr(\"stroke-linejoin\", \"round\").attr(\"stroke-linecap\", \"round\").attr(\"d\", line);\n    var zoom = d3.zoom().scaleExtent([1, 10]) // .extent([[margin.left, 0], [width - margin.right, height]])\n    // .translateExtent([[margin.left, -Infinity], [width - margin.right, Infinity]])\n    .translateExtent([[0, 0], [width, height]]).on(\"zoom\", () => {\n      const zoomState = zoomTransform(svg.node());\n      setCurrentZoomState(zoomState); // console.log(zoomState);\n    });\n    svg.call(zoom); // svg.call(zoom)\n    //   .transition()\n    //     .duration(750)\n    //     .call(zoom.scaleTo, 4, [scaleX(Date.UTC(2020, 10, 1)), 0]);\n    // function zoomed(event: any) {\n    //   g.attr(\"transform\", event);\n    // const xz = event.transform.rescaleX(scaleX);\n    // path.attr(\"d\", area(data, xz));\n    // changingXAxis.call(xAxis, xz);\n    // }\n  }, [currentZoomState, data]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"chart\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"svg\", {\n    ref: ref,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    className: \"graphContent\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"g\", {\n    className: \"x-axis\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"g\", {\n    className: \"y-axis\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 9\n    }\n  })));\n}\n\nexport default Chart;","map":{"version":3,"sources":["/Users/samzimmerman/Documents/Apps/Website/src/Weather/Chart.tsx"],"names":["d3","zoomTransform","React","useRef","useEffect","useState","Chart","width","height","data","ref","currentZoomState","setCurrentZoomState","svg","select","current","margin","top","right","bottom","left","dateDomain","extent","d","parseInt","date","tempRange","parseFloat","temps","scaleX","scaleUtc","domain","range","newXScale","rescaleX","scaleY","scaleLinear","nice","yAxis","g","attr","call","axisLeft","remove","clone","text","xAxis","axisBottom","line","x","y","linePath","datum","lastTime","lastTemp","index","length","error","lineLabel","style","endCircle","append","selectAll","join","zoom","scaleExtent","translateExtent","on","zoomState","node"],"mappings":"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","sourcesContent":["import * as d3 from \"d3\";\nimport { zoomTransform } from \"d3\";\nimport React, { useRef, useEffect, useState } from \"react\";\n\ntype propsStructure = {\n  width: number;\n  height: number;\n  data: dataStructure;\n};\ntype dataStructure = {\n  date: number;\n  temps: [string, string];\n};\n\nfunction Chart({ width, height, data }: any) {\n  const ref = useRef(null);\n  const [currentZoomState, setCurrentZoomState] = useState();\n\n  useEffect(() => {\n    const svg = d3.select(ref.current);\n    var margin = { top: 20, right: 50, bottom: 30, left: 40 };\n    var dateDomain = d3.extent(data, (d: any) => parseInt(d.date));\n    var tempRange = d3.extent(data, (d: any) => parseFloat(d.temps[0]));\n\n    var scaleX = d3\n      .scaleUtc()\n      .domain(dateDomain as [number, number])\n      .range([margin.left, width - margin.right]);\n\n    if (currentZoomState) {\n      let newXScale = (currentZoomState as any).rescaleX(scaleX);\n      scaleX.domain(newXScale.domain());\n    }\n\n    var scaleY = d3\n      .scaleLinear()\n      .domain(tempRange as [number, number])\n      .nice()\n      .range([height - margin.bottom, margin.top]);\n\n    function yAxis(g: any) {\n      g.attr(\"transform\", `translate(${margin.left}, 0)`)\n        .call(d3.axisLeft(scaleY))\n        .call((g: any) => g.select(\".domain\").remove())\n        .call((g: any) =>\n          g\n            .select(\".tick:last-of-type text\")\n            .clone()\n            .attr(\"x\", 3)\n            .attr(\"text-anchor\", \"start\")\n            .attr(\"font-weight\", \"bold\")\n            .text(\"Temperature\")\n        );\n    }\n\n    // function xAxis(g: any) {\n    //   g.attr(\"transform\", `translate(0,${height - margin.bottom})`).call(\n    //     d3\n    //       .axisBottom(scaleX)\n    //       .ticks(width / 80)\n    //       .tickSizeOuter(0)\n    //   );\n    // }\n    const xAxis = d3.axisBottom(scaleX);\n\n    let line = d3\n      .line()\n      .x((d: any) => scaleX(d.date))\n      .y((d: any) => scaleY(parseFloat(d.temps[0])));\n\n    function linePath(g: any) {\n      g.datum(data)\n        .attr(\"fill\", \"none\")\n        .attr(\"stroke\", \"steelblue\")\n        .attr(\"stroke-width\", 1.5)\n        .attr(\"stroke-linejoin\", \"round\")\n        .attr(\"stroke-linecap\", \"round\")\n        .attr(\"d\", line);\n    }\n\n    var lastTime: number;\n    var lastTemp: number;\n    if (data) {\n      try {\n        let index = data.length - 1;\n        lastTime = data[index].date;\n        lastTemp = parseFloat(data[index].temps[0]);\n      } catch (error) {}\n    }\n    function lineLabel(g: any) {\n      g.attr(\n        \"transform\",\n        \"translate(\" + (width - margin.left) + \",\" + scaleY(lastTemp) + \")\"\n      )\n        .attr(\"dy\", \".35em\")\n        .attr(\"text-anchor\", \"start\")\n        .style(\"fill\", \"steelblue\")\n        .text(lastTemp);\n    }\n    function endCircle(g: any) {\n      if (scaleY(lastTemp)) {\n        g.attr(\"fill\", \"steelblue\")\n          .attr(\n            \"transform\",\n            \"translate(\" + scaleX(lastTime) + \",\" + scaleY(lastTemp) + \")\"\n          )\n          .attr(\"r\", 3);\n      }\n    }\n\n    svg\n      .attr(\"width\", width)\n      .attr(\"height\", height)\n      .style(\"border\", \"1px solid black\");\n\n    // svg.append(\"g\").call(yAxis);\n    // svg.append(\"g\").call(xAxis);\n    svg\n      .select(\".x-axis\")\n      .attr(\"transform\", `translate(0,${height - margin.bottom})`)\n      .call(xAxis);\n    svg.select(\".y-axis\").call(yAxis);\n\n    svg.append(\"text\").call(lineLabel);\n    svg.append(\"circle\").call(endCircle);\n    // svg.append(\"path\").call(linePath);\n    svg\n      .select(\".graphContent\")\n      .selectAll(\".myLine\")\n      .data([data])\n      .join(\"path\")\n      .attr(\"class\", \"myLine\")\n      .attr(\"stroke\", \"steelblue\")\n      .attr(\"fill\", \"none\")\n      .attr(\"stroke-width\", 1.5)\n      .attr(\"stroke-linejoin\", \"round\")\n      .attr(\"stroke-linecap\", \"round\")\n      .attr(\"d\", line);\n\n    var zoom: any = d3\n      .zoom()\n      .scaleExtent([1, 10])\n      // .extent([[margin.left, 0], [width - margin.right, height]])\n      // .translateExtent([[margin.left, -Infinity], [width - margin.right, Infinity]])\n      .translateExtent([\n        [0, 0],\n        [width, height],\n      ])\n      .on(\"zoom\", () => {\n        const zoomState = zoomTransform(svg.node() as any);\n        setCurrentZoomState(zoomState as any);\n        // console.log(zoomState);\n      });\n\n    svg.call(zoom);\n    // svg.call(zoom)\n    //   .transition()\n    //     .duration(750)\n    //     .call(zoom.scaleTo, 4, [scaleX(Date.UTC(2020, 10, 1)), 0]);\n\n    // function zoomed(event: any) {\n    //   g.attr(\"transform\", event);\n    // const xz = event.transform.rescaleX(scaleX);\n    // path.attr(\"d\", area(data, xz));\n    // changingXAxis.call(xAxis, xz);\n    // }\n  }, [currentZoomState, data]);\n\n  return (\n    <div className=\"chart\">\n      <svg ref={ref}>\n        <g className=\"graphContent\"></g>\n        <g className=\"x-axis\"></g>\n        <g className=\"y-axis\"></g>\n      </svg>\n    </div>\n  );\n}\n\nexport default Chart;\n"]},"metadata":{},"sourceType":"module"}